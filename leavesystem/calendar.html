<div class="text-center">
  <label class="mb-2">เลือกเดือน:</label>
  <select id="monthSelect" onchange="renderCalendar()" class="form-select w-auto d-inline-block">
    <option value="0">มกราคม</option>
    <option value="1">กุมภาพันธ์</option>
    <option value="2">มีนาคม</option>
    <option value="3">เมษายน</option>
    <option value="4">พฤษภาคม</option>
    <option value="5">มิถุนายน</option>
    <option value="6">กรกฎาคม</option>
    <option value="7">สิงหาคม</option>
    <option value="8">กันยายน</option>
    <option value="9">ตุลาคม</option>
    <option value="10">พฤศจิกายน</option>
    <option value="11">ธันวาคม</option>
  </select>
</div>

<div class="table-responsive mt-3 d-flex justify-content-center">
  <table class="table table-bordered w-auto text-white">
    <thead class="table-secondary text-dark">
      <tr>
        <th>วันที่</th>
        <th>ชื่อผู้ลาที่ลงทะเบียนไว้</th>
      </tr>
    </thead>
    <tbody id="calendarBody"></tbody>
  </table>
</div>

<script>
  function renderCalendar() {
    const month = document.getElementById('monthSelect').value;
    google.script.run.withSuccessHandler(function(data) {
      const tbody = document.getElementById('calendarBody');
      tbody.innerHTML = '';
      for (let i = 1; i <= 31; i++) {
        if (!data[i]) continue;
        const tr = document.createElement('tr');
        const tdDate = document.createElement('td');
        tdDate.textContent = i;
        const tdName = document.createElement('td');
        tdName.innerHTML = data[i].join('<br>');
        tr.appendChild(tdDate);
        tr.appendChild(tdName);
        tbody.appendChild(tr);
      }
    }).getCalendarData(Number(month));
  }

  renderCalendar();
</script>
